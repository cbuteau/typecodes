"use strict";var TYPECODES={BOOLEAN:0,NUMBER:1,STRING:2,FUNCTION:3,OBJECT:4,UNDEFINED:5,NULL:6,DATE:7,ARRAY:8,UNMAPPED:9,REGEX:10};Object.freeze(TYPECODES);var DEFAULT_EPSILON=.001;function debugStringForTypeCode(typecode){var result="unmapped";switch(typecode){case TYPECODES.ARRAY:result="array";break;case TYPECODES.BOOLEAN:result="boolean";break;case TYPECODES.DATE:result="date";break;case TYPECODES.FUNCTION:result="function";break;case TYPECODES.NULL:result="null";break;case TYPECODES.NUMBER:result="number";break;case TYPECODES.OBJECT:result="object";break;case TYPECODES.REGEX:result="regex";break;case TYPECODES.STRING:result="string";break;case TYPECODES.UNDEFINED:result="undefined";break;case TYPECODES.UNMAPPED:default:result="unmapped"}return result}function getTypeCode(value){return void 0===value?TYPECODES.UNDEFINED:null===value?TYPECODES.NULL:!0===value||!1===value?TYPECODES.BOOLEAN:value.apply&&value.call&&value.bind?TYPECODES.FUNCTION:value.getDay&&value.getYear&&value.getMonth&&value.getHours&&value.getMinutes&&value.getSeconds?TYPECODES.DATE:value.toString&&value.valueOf&&value.toPrecision?TYPECODES.NUMBER:value.trim&&value.indexOf&&value.toLowerCase&&value.toUpperCase?TYPECODES.STRING:value.map&&value.indexOf&&value.push&&value.slice?TYPECODES.ARRAY:value.test&&value.exec?TYPECODES.REGEX:value.isPrototypeOf&&value.hasOwnProperty&&value.toString?TYPECODES.OBJECT:TYPECODES.UNMAPPED}function isTypeCode(value,code){return getTypeCode(value)===code}function validateFunction(func,paramCount){return getTypeCode(func)===TYPECODES.FUNCTION&&func.length===paramCount}function isNotThere(value){var code=getTypeCode(value);return code===TYPECODES.UNDEFINED||code===TYPECODES.NULL}function isFloat(value){return value%1!=0}function compareFloats(floatOne,floatTwo,options){return Math.abs(floatOne-floatTwo)<options.epsilon}function compareArray(arrayOne,arrayTwo){for(var test=!1,i=0;i<arrayOne.length&&(test=compare(arrayOne[i],arrayTwo[i]));i++);return test}function compareObject(objectOne,objectTwo,options){var propKeys=Object.keys(objectOne),propKeysTwo=Object.keys(objectTwo);if(propKeys.length!==propKeysTwo.length)return!1;for(var test=!1,i=0;i<propKeys.length;i++){var propKey=propKeys[i];if(!(test=compare(objectOne[propKey],objectTwo[propKey],options)))break}return test}function actualCompare(valueOne,valueTwo,typeCode,options){var result=!1;switch(typeCode){case TYPECODES.UNDEFINED:case TYPECODES.NULL:result=!0;break;case TYPECODES.BOOLEAN:case TYPECODES.STRING:case TYPECODES.FUNCTION:result=valueOne===valueTwo;break;case TYPECODES.DATE:result=valueOne.getTime()===valueTwo.getTime();break;case TYPECODES.REGEX:result=valueOne.toString()===valueTwo.toString();break;case TYPECODES.NUMBER:result=isFloat(valueOne)&&isFloat(valueTwo)?compareFloats(valueOne,valueTwo,options):valueOne===valueTwo;break;case TYPECODES.ARRAY:result=compareArray(valueOne,valueTwo,options);break;case TYPECODES.OBJECT:result=compareObject(valueOne,valueTwo,options)}return result}function compare(valueOne,valueTwo,options){options=options||{epsilon:DEFAULT_EPSILON};var codeOne=getTypeCode(valueOne);return codeOne===getTypeCode(valueTwo)&&actualCompare(valueOne,valueTwo,codeOne,options)}function exposedIsFloat(value){return getTypeCode(value)===TYPECODES.NUMBER&&isFloat(value)}function isAllValueTypes(obj){for(var propKeys=Object.keys(obj),i=0;i<propKeys.length;i++){var propCode=getTypeCode(obj[propKeys[i]]);if(propCode===TYPECODES.ARRAY||propCode===TYPECODES.OBJECT)return!1}return!0}function isValueType(obj){var code=getTypeCode(obj);return code!==TYPECODES.ARRAY&&code!==TYPECODES.OBJECT}function addUnique(array,item){-1===array.indexOf(item)&&array.push(item)}function buildCombinedPropList(objOne,objTwo){for(var keysOne=Object.keys(objOne),keysTwo=Object.keys(objTwo),result=[],i=0;i<keysOne.length;i++)addUnique(result,keysOne[i]);for(var j=0;j<keysTwo.length;j++)addUnique(result,keysTwo[j]);return result}function mergeArrays(arrayOne,arrayTwo){for(var combined=[],i=0;i<arrayOne.length;i++)current=arrayOne[i],-1===combined.indexOf(current)&&combined.push(current);for(var j=0;j<arrayTwo.length;j++){var current=arrayTwo[j];-1===combined.indexOf(current)&&combined.push(current)}return combined}function deepAssign(objOne,objTwo){if(isNotThere(objOne))return objTwo;if(isNotThere(objTwo))return objOne;var isValueOne=isValueType(objOne),isValueTwo=isValueType(objTwo);if(isValueOne&&isValueTwo)return objTwo;var isOneValues=isAllValueTypes(objOne),isTwoValues=isAllValueTypes(objTwo);if(isOneValues&&isTwoValues)return isTypeCode(objOne,TYPECODES.ARRAY)&&isTypeCode(objTwo,TYPECODES.ARRAY)?mergeArrays(objOne,objTwo):Object.assign(objOne,objTwo);for(var resultObj={},combined=buildCombinedPropList(objOne,objTwo),i=0;i<combined.length;i++){var current=combined[i];resultObj[current]=deepAssign(objOne[current],objTwo[current])}return resultObj}function FunctionMap(prop){this.paramCount=prop.length}function CallbackMap(interfaceObj){this.interfaceObj=interfaceObj,this.map={},this.build()}function hasInterface(obj,interfaceObj){return new CallbackMap(interfaceObj).isValid(obj)}function hasPropMap(objectToTest,propMap){for(var keys=Object.keys(propMap),mapCount=0,i=0;i<keys.length;i++){var key=keys[i];getTypeCode(objectToTest[key])===propMap[key]&&mapCount++}return mapCount===keys.length}function coerceStringToBool(value){return"true"===value.toLowerCase()}CallbackMap.prototype={build:function(){for(var keys=Object.keys(this.interfaceObj),i=0;i<keys.length;i++){var prop=keys[i],propVal=this.interfaceObj[prop];isTypeCode(propVal,TYPECODES.FUNCTION)&&(this.map[prop]=new FunctionMap(propVal))}},isValid:function(objectToTest){for(var callbacks=Object.keys(this.map),validcount=0,i=0;i<callbacks.length;i++){var cbName=callbacks[i],propVal=objectToTest[cbName],funcMap=this.map[cbName];isTypeCode(propVal,TYPECODES.FUNCTION)&&propVal.length===funcMap.paramCount&&validcount++}return validcount===callbacks.length}};var regexInt=/^[-+]?\d+$/;function coerceStringToNumber(value){return regexInt.test(value)?parseInt(value,10):parseFloat(value)}function coerceStringToDate(value){return new Date(Date.parse(value))}function coerceStringToArray(value){var temp=JSON.parse(value);if(Array.isArray(temp))return temp;noCoerce()}function coerceStringToRegex(value){return new RegExp(value)}function noCoerce(){throw new Error("No coersion possible")}function coerceToNull(value){return null}function coerceToUndefined(value){}function coerceArrayToString(value){return JSON.stringify(value)}function coerceNumberToDate(value){return new Date(value)}function coerceNumberToString(value){return""+value}function convertObjectToString(value){return JSON.stringify(value)}function coerceAnyToBool(value){return!!value}function coerceAnyToString(value){return value.toString()}var COERCEMAP={};function buildCoerceMap(){if(!COERCEMAP[TYPECODES.STRING]){var funcMap=COERCEMAP[TYPECODES.STRING]={};funcMap[TYPECODES.BOOLEAN]=coerceStringToBool,funcMap[TYPECODES.NUMBER]=coerceStringToNumber,funcMap[TYPECODES.FUNCTION]=noCoerce,funcMap[TYPECODES.ARRAY]=coerceStringToArray,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.DATE]=coerceStringToDate,funcMap[TYPECODES.REGEX]=coerceStringToRegex,funcMap[TYPECODES.UNMAPPED]=noCoerce,(funcMap=COERCEMAP[TYPECODES.BOOLEAN]={})[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.FUNCTION]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.DATE]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=coerceAnyToString,(funcMap=COERCEMAP[TYPECODES.ARRAY]={})[TYPECODES.BOOLEAN]=noCoerce,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.FUNCTION]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.DATE]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=coerceArrayToString,(funcMap=COERCEMAP[TYPECODES.NUMBER]={})[TYPECODES.BOOLEAN]=coerceAnyToBool,funcMap[TYPECODES.FUNCTION]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.DATE]=coerceNumberToDate,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=coerceNumberToString,(funcMap=COERCEMAP[TYPECODES.FUNCTION]={})[TYPECODES.BOOLEAN]=noCoerce,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.DATE]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=noCoerce,(funcMap=COERCEMAP[TYPECODES.OBJECT]={})[TYPECODES.BOOLEAN]=coerceAnyToBool,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.DATE]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=convertObjectToString,(funcMap=COERCEMAP[TYPECODES.UNDEFINED]={})[TYPECODES.BOOLEAN]=coerceAnyToBool,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.NULL]=coerceToNull,funcMap[TYPECODES.OBJECT]=noCoerce,funcMap[TYPECODES.DATE]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=noCoerce,(funcMap=COERCEMAP[TYPECODES.NULL]={})[TYPECODES.BOOLEAN]=coerceAnyToBool,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.OBJECT]=noCoerce,funcMap[TYPECODES.DATE]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=noCoerce,(funcMap=COERCEMAP[TYPECODES.DATE]={})[TYPECODES.BOOLEAN]=coerceAnyToBool,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.OBJECT]=noCoerce,funcMap[TYPECODES.FUNCTION]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=noCoerce,(funcMap=COERCEMAP[TYPECODES.REGEX]={})[TYPECODES.BOOLEAN]=coerceAnyToBool,funcMap[TYPECODES.NUMBER]=noCoerce,funcMap[TYPECODES.ARRAY]=noCoerce,funcMap[TYPECODES.OBJECT]=noCoerce,funcMap[TYPECODES.FUNCTION]=noCoerce,funcMap[TYPECODES.REGEX]=noCoerce,funcMap[TYPECODES.UNDEFINED]=coerceToUndefined,funcMap[TYPECODES.UNMAPPED]=noCoerce,funcMap[TYPECODES.STRING]=coerceAnyToString}}function coerce(value,typeCode){var currentTc=getTypeCode(value);return currentTc===typeCode?value:(buildCoerceMap(),COERCEMAP[currentTc][typeCode](value))}var exposed={CODES:TYPECODES,get:getTypeCode,is:isTypeCode,isNotThere:isNotThere,validateFunction:validateFunction,str:debugStringForTypeCode,isFloat:exposedIsFloat,compare:compare,coerce:coerce,has:hasPropMap,hasInterface:hasInterface,deepAssign:deepAssign};"function"==typeof define&&define.amd?define(function(){return exposed}):"object"==typeof exports?module.exports=exposed:window.tc=exposed;